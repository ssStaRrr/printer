<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASIL</title>
    <!-- INCLUDE BOOTSTRAP  -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <style>
        body {
            font-size: 1.5rem;
        }

        #content {
            font-size: 1rem;
            background-color: rgb(119, 112, 112);
            position: relative;
            width: 400px;
            display: flex;
            align-items: flex-start;

        }

        #content img {
            width: 100%;
            height: auto;
            display: block;
        }

        .onYuz {
            width: 400px;
            height: auto;
            display: block;
        }

        .arkaYuz {
            width: 400px;
            height: auto;
            display: block;
        }

        /* FOR PRİNTER */
        @media print {
            body * {
                display: none;
            }

            #content,
            #content * {
                display: block;
            }
        }
    </style>
</head>

<body>
    <p>deneme</p>

    <button id="print"> print this content </button>
    <div id="content">

        <img src="images/ön.jpg" alt="onYuz">
        <img src="images/arka.jpg" alt="arkaYuz">
    </div>

    <div class="row">
        <div class="col deneme">
            <h2>Select File to Upload</h2>
            <input type="file" id="fileInput" accept=".xlsx, .xls" />
            <button onclick="parseExcel()">Parse Excel</button>
            <p>deneme</p>
        </div>
        <div class="col">
            <img class="onYuz" src="images/ön.jpg" alt="onYuz">
        </div>
        <div class="col">
            <img class="arkaYuz" src="images/arka.jpg" alt="arkaYuz">
        </div>
    </div>

    <script>
        function parseExcel() {
            //Get the Input Element
            const fileInput = document.getElementById("fileInput")
            const pElement = document.querySelector(".deneme p")

            // Check if a file is selected
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0]

                //Create a new FileReader
                const reader = new FileReader()
                
                // Set up the onload event to handle the file
                reader.onload = function (e) {
                    const data = e.target.result
                    
                    // Use SheetJS to parse the Excel file
                    const workbook = XLSX.read(data, { type: 'binary' });
                    const sheetName = workbook.SheetNames[0];
                    const sheet = workbook.Sheets[sheetName];

                    // Extract values from the sheet
                    const parsedData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

                    // Log or use the parsed data as needed
                    console.log(parsedData[1][1]);

                    if(pElement) {
                        pElement.textContent = `${parsedData[1][1]}`
                    }
                }
                // Read the file as binary
                reader.readAsBinaryString(file);
            }
            else {
                alert('Please select an Excel file.');
            }
        }
        const printBtn = document.getElementById("print")
        printBtn.addEventListener("click", () => {
            window.print()
        })
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script>
</body>

</html>